# Data Science HW3

This assignment aims to train a node classification model on an unknown graph dataset.

## Model

There are several node classification model, including GCN, SSP and GAT, contained in this code.

The SSP model follows the source code provided in the [github](https://github.com/russellizadi/ssp) page. And the GAT model mainly follows the [sample code](https://github.com/pyg-team/pytorch_geometric/blob/master/examples/gat.py) provided by the dgl team with modification according to the implementaion in [link](https://github.com/dmlc/dgl/blob/master/examples/pytorch/gat/train.py)

After the training, it will perform a simple voting of models (if there are more than two models). The result will be write to the `output.csv` file.

## Dataset

**Unknown graph data**
  * Label Split:
    * Train: 60, Valid: 500, Test: 1000
    
**File name description**
  ```
    dataset
    │   ├── private_features.pkl # node feature
    │   ├── private_graph.pkl # graph edges
    │   ├── private_num_classes.pkl # number of classes
    │   ├── private_test_labels.pkl # X
    │   ├── private_test_mask.pkl # nodes indices of testing set
    │   ├── private_train_labels.pkl # nodes labels of training set
    │   ├── private_train_mask.pkl # nodes indices of training set
    │   ├── private_val_labels.pkl # nodes labels of validation set
    │   └── private_val_mask.pkl # nodes indices of validation set
  ```

## Environment

**Requirements:**
* python `3.10.1`
* pyTorch `2.0.1`
* PyG `2.3.1`
* dgl `1.1.0`

**Create with conda**
```
conda env create
conda activate HW3
```

**Sample code**

```
python3 train.py --gat --ssp
```

**Running options**

There are options to run the code. You can choose which model you want to  

`--all` to run all models

`--gcn` | `--ssp` | `--gat` to train corresponding model.

`--seed` to set the random seed (default=None)


## Result

The final result is generated by SSP models with different hidden layer sizes. The final result is voted by these models, and it reaches accuracy of 0.785 ± 0.1

The given version of code is the implementation. You can derived similar result by running the command:

```
python3 train.py --ssp
```

